import nu.studer.gradle.jooq.JooqEdition

description = "adapter-output-h2"

plugins {
    kotlin("jvm")
    kotlin("plugin.spring")
    id("nu.studer.jooq") version "4.1"
    id("java-library")
}

dependencies {
    val springBootVersion: String by project

    jooqRuntime("com.h2database:h2:1.4.193")
    implementation(project(":voter-application-core"))
    implementation("org.springframework.boot:spring-boot-starter-jooq:$springBootVersion")
}

tasks.withType<nu.studer.gradle.jooq.JooqTask> {
    jooq {
        version = "3.13.0"
        edition = JooqEdition.OSS
        sample(sourceSets.main) {
            jdbc {
                driver = "org.h2.Driver"
                url = "jdbc:h2:~/test;AUTO_SERVER=TRUE"
                user = "sa"
                password = ""
            }
            generator {
                name = "org.jooq.codegen.DefaultGenerator"
                database {
                    name = "org.jooq.meta.h2.H2Database"
                    includes = ".*"
                    excludes = ""
                }
                generate {
                    isDeprecated = false
                    isRecords = false
                    isImmutablePojos = false
                    isFluentSetters = false
                }
                target {
                    packageName = "com.hexarchbootdemo.adapter.persistence.h2"
                }
                strategy {
                    name = "org.jooq.codegen.DefaultGeneratorStrategy"
                }
            }
        }
    }
}
